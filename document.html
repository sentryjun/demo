<html>
	<body>
		<meta charset="utf-8">
		<h1 id="-">计算概论大作业选课系统</h1>
		<p>高俊&emsp;<a href="&#109;&#97;&#x69;&#108;&#x74;&#111;&#x3a;&#49;&#x36;&#48;&#48;&#48;&#x31;&#x31;&#x38;&#x33;&#x37;&#x40;&#112;&#107;&#x75;&#x2e;&#x65;&#x64;&#x75;&#46;&#99;&#x6e;">&#49;&#x36;&#48;&#48;&#48;&#x31;&#x31;&#x38;&#x33;&#x37;&#x40;&#112;&#107;&#x75;&#x2e;&#x65;&#x64;&#x75;&#46;&#99;&#x6e;</a></p>
		<h2 id="-">一、 概况</h2>
		<ul>
		<li><h3 id="-">开发环境</h3>
		<ul>
		<li>QT 5.6.3 64-bit MSVC</li>
		<li>编译器：MSVC 2015</li>
		</ul>
		</li>
		<li><h3 id="-">教务系统的基本功能</h3>
		</li>
		</ul>
		<blockquote>
		<ol>
		<li>学生登录，注册，教务的登陆</li>
		<li>学生可以选课、查询、退课，学分默认上限为25学分</li>
		<li>教务可以添加、删除课程，并且教务可以修改课程的人数上限，教务可以添加学生</li>
		<li>课程的属性有学分，人数上限， 已选人数</li>
		<li>学生选课时可以超过课程的人数上限，此种情况下，教务可以执行随机抽选操作，按照随机的方法是课程选课人数与上限相等</li>
		<li>较为友好的图形界面能够实现可视化操作</li>
		</ol>
		</blockquote>
		<h2 id="-">二、实现</h2>
		<h3 id="1-">1. 选课系统</h3>
		<p>&emsp;&emsp;在我看来，选课系统就是一个学生和课程的管理系统。在这个系统中，有两类主要的对象，学生和课程。学生的选课退课即在学生的课程属性里添加一个课程的记录，同时要对学生的剩余学分、课程的选课人数等进行维护。教务添加课程、学生就是创建了一个课程学生的记录。这就涉及到一个数据存储的问题，需要选取合适的方式对数据进行存储。一开始，我首先想到的是用数据库存储，但是由于数据库对我来说太过复杂，无法在短时间内学会，很快就否决了这种方案。随后，我又想到用json存储学生和课程，但是在我的一些尝试中，或多或少地会出现一些问题，例如读取失败、编译失败等。碍于目前的知识，尚不能比较好地解决这些问题，因此，我最后选择了用最简单的文件读写来实现。</p>
		<p>&emsp;&emsp;最终我的数据分别存储在两个文件中，一个为student另一个为courses，在这两个文件中，每一行包含了一个学生或者一个课程的全部信息。对选课等操作就可以转化为对这两个文件内容的操作。对于课程与学生，我选择用课程号和学号作为区分每个个体的标志，用课程号号选退课就是读取这些内容,对我下图中的某些属性进行修改即可。</p>
		<p><img src="https://github.com/sentryjun/My_Study/raw/master/image/structure.png" alt="两个文件中的数据格式"></p>
		<h3 id="2-qt-">2. Qt的使用</h3>
		<p>&emsp;&emsp;在图形界面实现上我选择了Qt环境。选择这个的主要原因是学习起来比较简单，能够比较快的入门。qt主要是面向对象的思想，虽然还没有学到C++面向对象 编程，但此前学习python时，曾经广泛使用到这一思想，因此用起来比较顺手。qt中的QString、QList等与C++ STL中的String等相比，操作上更加便捷，这也是我选择qt的一个原因。在整个过程中，我一共实现了9个不同的界面，这些界面的功能有着较大的区别，我分别在这些界面上实现不同的函数以实现功能。</p>
		<h2 id="-">三、使用流程以及细节</h2>
		<ul>
		<li><h3 id="-">欢迎与登录注册界面</h3>
		<p>  在我的选课系统中，第一次登录的学生需要注册，注册需要提供姓名、学号、密码、院系、年级等信息。注册成功后，将在student文件上创建一条student的记录。并可以用学号和密码登录。而教务可以直接用密码登录。登录后将进入分别进入学生和教务的主操作界面。</p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213153202.png" alt="欢迎界面"></p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213153220.png" alt="学生登录"></p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213153228.png" alt="学生注册"></p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213155127.png" alt="教务登录"></p>
		</li>
		<li><h3 id="-">学生主界面</h3>
		<p>  进入学生的主界面，默认将会显示学生的基本信息与学生当前已选的课程，学生还可以查看全部课程。课程的信息显示在表格里，学生可以右键单击课程，通过右键菜单来进行选课和退课。每进行操作需要刷新页面。</p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213153238.png" alt="学生操作界面"></p>
		</li>
		<li><h3 id="-">教务的课程管理与学生管理</h3>
		<p>  教务默认页面是课程管理，教务可以通过搜索框输入课号或者名称查找课程看选课情况，同样也可以使用右键菜单查看。教务可以通过添加课程按钮来添加课程，也可以打开学生管理。通过右键菜单，教务可以查看选课情况、删除课程、修改课程选课人数上限。当课程选课人数超过上限时，可以随机抽选。操作后同样需要刷新。</p>
		<p>  教务此外还可以打开学生管理窗口，通过这一窗口，教务可以查看学生的情况，并且还可以添加学生。</p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213153245.png" alt="教务主页面"></p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213155156.png" alt="添加课程"></p>
		<p>  <img src="https://github.com/sentryjun/My_Study/raw/master/image/20171213153254.png" alt="学生管理"></p>
		</li>
		</ul>
		<h2 id="-">四、遇到的问题与解决方案、项目的不足与改进空间</h2>
		<ul>
		<li><h3 id="-">问题与解决</h3>
		<ol>
		<li><p>删除课程遇到的数据同步的问题</p>
		<p> 在我的这个选课系统中，操作最为复杂的就是删除课程这一操作，由于这一操作涉及到两个文件的读写与一致性，在我最开始的代码中，直接对两个文件进行操作，总是会出现两个文件信息不同步，导致程序出错。后来我想到的解决办法为，在删除课程信息前，先搜索一下选这个课的学生，然后对每个学生先执行退课操作，再删除课程信息。这个方法解决了这一问题，不足的时会导致程序的内存占用增加，不过在这个系统中，还可以接受。</p>
		</li>
		<li><p>字符串表越界问题</p>
		<p> Qt中提供了QStringList的容器，在读取文件时通过QStringList可以比较方便地暂时存储数据。但是在写程序时我最常遇到就是字符串表的越界。一开始百思不得其解，后来我查看了两个数据文件才发现了了问题的所在。原来程序的一些操作会导致文件的某一行变为空字符串，而将空字符串变为list，再对list操作时就会出现问题。所以排除掉这种情况就可以避免这种问题。</p>
		</li>
		<li><p>其他一些小问题</p>
		<p> 刚开始用Qt时，配置msvc的环境最为痛苦（其实是下错了版本不得不用msvc编译），配置系统环境变量各种出错，最后看了vs的文档解决。</p>
		<p> 写这个作业时开始常有乱码，后来发现是编码的问题，再中文字符串前加u8很容易就解决了。</p>
		</li>
		</ol>
		</li>
		<li><h3 id="-">收获与不足</h3>
		<ol>
		<li><p>项目的一些不足与改进空间</p>
		<p> 由于自己的能力和C++知识有限，这个选课系统还存在一些不足。例如，内存控制的问题，由于采用了文件的存储，在实现各种操作时经常需要将整个文件的内容保存到数组中，如果数据量太大可能会造成内存的浪费。此外，我在设计超课程人数上限选课的时候直接认为其已经选课，再通过教务随机抽选操作退课再实际应用中，并不合理，应该进行改正。并且现在我的程序无法加入意愿点操作可以说比较遗憾。此外课程查询的功能非常naive，只能提供精确查找。</p>
		<p> 为此我想了一些可能的改进措施，如利用数据库来保存这些数据。为了解决意愿点等问题，我想可能采取在选课数据和操作之间加一个“缓冲层”。即类似于北大选课系统中的选课流程。学生层面的选课操作都是对缓冲层内的数据进行，学生可以投意愿点。教务层面可以抽签根据一定的公式，抽选课程，抽选后写入实际的数据库或者文件中。此外还可以更改搜索函数，实现精确查找，不过字符串匹配的算法我还是比较naive，暂时无法实现。</p>
		</li>
		<li><p>收获</p>
		<p> 首先是学会了用QT写有图形界面的程序，同时对面向对象的编程思想有了进一步地认识。</p>
		<p> 其次，我通过这一次比较大规模的项目，使我对大型项目的开发有了一点“感觉”。在写这个的时候，我认识到了debug的重要性，通过反复debug往往可以找到一些不容易发现的bug，提高代码的质量。另外，学会预留接口，对重复或者相似的操作使用统一的模板等都比较重要</p>
		<p> 最后，感谢崔老师和助教的辛勤付出。</p>
		</li>
		</ol>
		</li>
		</ul>
		
</body>
</html>